```
gcc的程序构建过程
将.c文件 源代码 进行预处理(preprocess)得到 .i 文件
对 .i文件 进行汇编操作(assemble)得到 .s 文件
对 .s 文件进一步编译操作(compile)得到 .o 二进制文件
对 .o文件 进行链接(link)得到 可执行文件 
依次的命令行为：
$ gcc -E <>.c -o <>.i
$ gcc -S <>.i -o <>.s
$ gcc -c <>.s -o <>.o
$ gcc <>.o -o <> # 无参数

gcc其他命令行
指定头文件的搜索路径
-I (ubuntu12之后的版本可以加空格)
-O 是否进行优化（0：不优化 1：default 2 3最高级别的优化）
-D 指定宏（e.g. -D DEBUG  等效于程序里面的 #define DEBUG)
-Wall 是否输出警告信息
-g    配合gdb调试工具使用，在生成的代码中添加调试信息


优化（e.g. 去冗余的代码）：
int a = 10;
int b = a;
int c = b;
int d = c; 
经优化后得到的是：
ind d = 10;
警告信息（e.g. 某些变量没用到）

```





# 使用distcc和dmucs进行分布式编译

## 术语

客户端(client)：含待编译的对象

服务端(server)：负责编译的及其



## 服务端配置

```bash
# 查询主机名
$ cat /etc/hostname
# 下载相关依赖
$ sudo apt install distcc dmucs
# 修改distcc的配置文档
$ sudo vim /etc/default/distcc

# >>> distcc配置文档 >>> 
# 启动自启动
STARTDISTCC="true"
# 配置允许连接的网络/主机
ALLOWEDNETS="127.0.0.1 10.23.21.0/24"
# 配置需要监听的网卡
LISTENER=""

# 修改dmucs的配置文档
$ sudo vim /etc/default/dmucs

# >>> dmucs配置文档 >>> 
# SERVER=yes  (default: no)

$ sudo vim /etc/default/dmucs
# >>> dmucs配置文档：填写实际参与编译的机器信息 >>> 
# <host_name> 2 4 （第1个是计算机名，第2个是CPU个数，第3个是性能指数）
# e.g. ah_chung 2 2

# 启动distcc服务
$ sudo systemctl start distcc.service

# 启动dmucs服务
$ sudo dmucs  						# （可显示出任务分配情况）
(or) $ sudo service dmucs start  	# （不显示任务分配情况）
```

notes：

1. 服务器端会根据客户端的CPU个数及性能指数进行任务分配，即如果想让哪台客户端多些任务，调下CPU和性能指数大小即可
2. distccd负责网络数据的处理，后者可以认为是g++的前端，调用g++进行编译



## 客户端配置

```bash
# 下载相关依赖
$ sudo apt install distcc dmucs
# 修改distcc的配置文档
$ sudo vim /etc/default/distcc

# >>> distcc配置文档 >>> 
# 配置自启动
STARTDISTCC="true"
ALLOWEDNETS="127.0.0.1"
LISTENER="" （默认为127.0.0.1，建议清空，否则会失败）

# 修改dmucs的配置文档
$ sudo vim /etc/default/dmucs

# >>> dmucs配置文档 >>> 
USE_SERVER=<server_host_ip>

# 启动distcc服务
$ sudo /etc/init.d/distcc start

# 启动dmucs服务
$ sudo dmucs  						# （可显示出任务分配情况）
(or) $ sudo service dmucs start  	# （不显示任务分配情况）

# 增加环境变量
export PATH=/usr/lib/distcc:${PATH}
export CC="gethost --server <server_hostname> distcc"

# 判断是否显示/usr/lib/distcc/gcc
$ which gcc
```



## 查看任务分配情况

```bash
# bash界面
$ distccmon-text
# 图形化界面（可apt安装）
$ distccmon-gnome
```







## 参考资料

1. [Ubuntu安装distcc+dmucs（分布式编译）步骤](https://blog.51cto.com/yangzhiming/1189445)