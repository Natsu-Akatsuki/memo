.. role:: raw-html-m2r(raw)
   :format: html


Remote Connect
==============

ssh
---


* 一台电脑对应一个私钥才能成功配置，尚未试一台机上多个私钥
* ssh系统配置文档： ``/etc/ssh/sshd_config``

.. attention::  对 `ssh文件权限有严格的要求 <https://docs.digitalocean.com/products/droplets/resources/troubleshooting-ssh/authentication/>`_ bash


`服务器免密登录 <https://wiki.archlinux.org/title/SSH_keys#Copying_the_public_key_to_the_remote_server>`_
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


* 使用命令行 ``ssh-copy-id`` 更方便

.. prompt:: bash $,# auto

   $ ssh-copy-id username@remote-server.org

X11转发
^^^^^^^


* 使远程X11程序(e.g. firefox, gedit)在本地显示
* 远程服务器的配置文件 ``/etc/ssh/sshd_config`` 的\ ``X11Forwarding`` 需设置为yes

.. prompt:: bash $,# auto

   $ ssh -X user_name@ip_address


* 适用于显示一些流量不大的x client或只是短时间可视化的操作（不然受传输速度限制会很卡）

ssh GUI
^^^^^^^

在实际的使用中ssh命令行比ssh GUI使用更频繁


* `snowflake <https://github.com/subhra74/snowflake>`_\ (bin安装)
* `easyssh(远程登录） <https://github.com/muriloventuroso/easyssh#install-with-flatpak>`_\ 使用flatpak安装（tested）；\ `卸载 <https://discover.manjaro.org/flatpaks/com.github.muriloventuroso.easyssh>`_

.. note:: easyssh实测在ubuntu20下有问题，体感不好


`ConnectBot <https://connectbot.org/>`_\ (安卓端ssh)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

提供相关IP地址即可，最终效果如下：

:raw-html-m2r:`<img src="https://natsu-akatsuki.oss-cn-guangzhou.aliyuncs.com/img/image-20211202105905884.png" alt="image-20211202105904455" style="zoom: 33%;" />`

vnc
---

安装相关依赖
^^^^^^^^^^^^

.. prompt:: bash $,# auto

   # 服务端（受控端）安装
   $ tigervnc-common tigervnc-standalone-server

服务端修改配置文档
^^^^^^^^^^^^^^^^^^

添加文件\ ``~.vnc/xstartup``


* 使用KDE ssdm display manager

.. prompt:: bash $,# auto

   #!/bin/bash
   unset SESSION_MANAGER
   unset DBUS_SESSION_BUS_ADDRESS
   dbus-launch startplasma-x11


* 使用xfce display manager

.. prompt:: bash $,# auto

   #!/bin/bash
   unset SESSION_MANAGER
   unset DBUS_SESSION_BUS_ADDRESS
   exec startxfce4

启动vnc server
^^^^^^^^^^^^^^

.. prompt:: bash $,# auto

   # 尺寸/配置文件/控制端口号
   $ vncserver [-geometry 1920x1080] [-xstartup /usr/bin/xterm] :1

启动vnc client
^^^^^^^^^^^^^^

客户端启动vnc client

.. prompt:: bash $,# auto

   # 安装vncviewer
   $ sudo apt install tigervnc-viewer
   # ssh helios@192.168.1.112 -L 5901:127.0.0.1:5901
   $ ssh <server username>@<server ip> -L 5901:127.0.0.1:5901
   # 新开一个终端，账号为localhost:5901，密码为服务端的密码
   $ vncviewer

----

**NOTE**

.. prompt:: bash $,# auto

   # ssh -L [bind_address:]port:host:hostport
   端口绑定，将bind_address:port映射到host:hostport

----
